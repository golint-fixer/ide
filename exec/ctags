#!/bin/bash -e
IDE_PREFIX="ide/ctags"

test -z "$IDE_PATH" && exit 1

# Include common functions
. "$IDE_PATH/lib/functions.sh"


CTAGS_CONFIG=`git config --null ide.ctags.config`


log "Warming up the ctags cache..."
log "Using ctags options file $CTAGS_CONFIG"


# TODO this --vendors command should not be symfony2 specific!
if [[ '--vendors' == "$1" ]]
then

    log "Creating tags in ${GIT_DIR}/tags_vendors"

    find vendor -type f -name '*.php' | \
        ctags -L - --tag-relative --options=${CTAGS_CONFIG} -o ${GIT_DIR}/tags_vendors > /dev/null 2>&1

else

    log "Creating tags in ${GIT_DIR}/tags"

    git ls-files | \
        ctags -L - --tag-relative --options=${CTAGS_CONFIG} -o ${GIT_DIR}/tags > /dev/null 2>&1

fi

log "Done."
