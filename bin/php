#!/bin/sh
if [ -z "$IDE_PHP_IMAGE" ]
then
    echo "[ERROR] IDE_PHP_IMAGE not set"
    exit 1
fi

if test -t 0
then
    opts="--tty"
else
    opts=""
fi

exec docker run --rm --interactive $opts \
    --add-host 'git.ocom.com:10.0.3.19' \
    --add-host 'api.leaseweb.com:10.11.11.98' \
    --add-host 'auth.leaseweb.com:10.11.11.98' \
    --env "SSH_AUTH_SOCK=$SSH_AUTH_SOCK" \
    --network ide_default \
    --user '1000:100' \
    --volume "$SSH_AUTH_SOCK:$SSH_AUTH_SOCK" \
    --volume "$PWD:$PWD" \
    --volume '/var/lib/ide/composer:/composer' \
    --volume "ide_static:/static" \
    --workdir "$PWD" \
    --entrypoint='php' \
    "$IDE_PHP_IMAGE" \
    "$@"
